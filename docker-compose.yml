services:
  gcli2api:
    image: ghcr.io/su-kaka/gcli2api:latest
    container_name: gcli2api
    restart: unless-stopped
    ports:
      - "8081:8080"
    environment:
      # 使用通用密码（推荐用于简单部署）
      - PASSWORD=pwd
      - PORT=8080
      # 或使用分离密码（推荐用于生产环境）
      # - API_PASSWORD=your_api_password
      # - PANEL_PASSWORD=your_panel_password
    volumes:
      - ./data/creds:/app/creds
    healthcheck:
      test: ["CMD-SHELL", "python -c \"import urllib.request; req = urllib.request.Request('http://localhost:8080/v1/models', headers={'Authorization': 'Bearer pwd'}); exit(0 if urllib.request.urlopen(req, timeout=5).getcode() == 200 else 1)\""]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
